# API Route Flag Summary (Heuristic)

Generated from docs/security-audit/2025-12-16/api_route_security_matrix.csv.
Note: flags are heuristic; some are expected (e.g. webhooks).

Routes with >=1 flag: 100

## CORS_HEADERS_PRESENT (1)
- /api/ocr/scan-receipt (app/api/ocr/scan-receipt/route.ts)

## FETCH_USED (10)
- /api/geolocation (app/api/geolocation/route.ts)
- /api/privacy/preferences (app/api/privacy/preferences/route.ts)
- /api/recipes/external/apininjas/search (app/api/recipes/external/apininjas/search/route.ts)
- /api/recipes/external/cuisine (app/api/recipes/external/cuisine/route.ts)
- /api/recipes/external/random (app/api/recipes/external/random/route.ts)
- /api/recipes/external/search (app/api/recipes/external/search/route.ts)
- /api/recipes/external/spoonacular/search (app/api/recipes/external/spoonacular/search/route.ts)
- /api/recipes/external/tasty/search (app/api/recipes/external/tasty/search/route.ts)
- /api/weather/forecast (app/api/weather/forecast/route.ts)
- /api/weather/geocode (app/api/weather/geocode/route.ts)

## RETURNS_SESSION_OBJECT (2)
- /api/auth/signin (app/api/auth/signin/route.ts)
- /api/auth/signup (app/api/auth/signup/route.ts)

## STATE_CHANGE_NO_AUTH_CHECK_DETECTED (19)
- /api/admin/feature-usage (app/api/admin/feature-usage/route.ts)
- /api/admin/feedback/status (app/api/admin/feedback/status/route.ts)
- /api/admin/notifications/bulk-unsubscribe (app/api/admin/notifications/bulk-unsubscribe/route.ts)
- /api/admin/notifications/export (app/api/admin/notifications/export/route.ts)
- /api/admin/users/[userId]/[action] (app/api/admin/users/[userId]/[action]/route.ts)
- /api/auth/magic-link (app/api/auth/magic-link/route.ts)
- /api/auth/magic-link/verify (app/api/auth/magic-link/verify/route.ts)
- /api/auth/password-reset (app/api/auth/password-reset/route.ts)
- /api/auth/password-reset/verify (app/api/auth/password-reset/verify/route.ts)
- /api/auth/signin (app/api/auth/signin/route.ts)
- /api/auth/signout (app/api/auth/signout/route.ts)
- /api/auth/signup (app/api/auth/signup/route.ts)
- /api/cookies (app/api/cookies/route.ts)
- /api/launch/notify (app/api/launch/notify/route.ts)
- /api/privacy/generate-export (app/api/privacy/generate-export/route.ts)
- /api/settings/privacy-data (app/api/settings/privacy-data/route.ts)
- /api/shopping/share/[token] (app/api/shopping/share/[token]/route.ts)
- /api/test/email-templates (app/api/test/email-templates/route.ts)
- /api/weather/user-location (app/api/weather/user-location/route.ts)

## STATE_CHANGE_NO_CSRF_TOKEN_VALIDATION (88)
- /api/admin/feature-usage (app/api/admin/feature-usage/route.ts)
- /api/admin/feedback/[id] (app/api/admin/feedback/[id]/route.ts)
- /api/admin/feedback/status (app/api/admin/feedback/status/route.ts)
- /api/admin/logs (app/api/admin/logs/route.ts)
- /api/admin/notifications/bulk-unsubscribe (app/api/admin/notifications/bulk-unsubscribe/route.ts)
- /api/admin/notifications/export (app/api/admin/notifications/export/route.ts)
- /api/admin/users/[userId]/[action] (app/api/admin/users/[userId]/[action]/route.ts)
- /api/analytics/track (app/api/analytics/track/route.ts)
- /api/auth/beta-signup (app/api/auth/beta-signup/route.ts)
- /api/auth/cleanup-orphaned-user (app/api/auth/cleanup-orphaned-user/route.ts)
- /api/auth/magic-link (app/api/auth/magic-link/route.ts)
- /api/auth/magic-link/verify (app/api/auth/magic-link/verify/route.ts)
- /api/auth/password-reset (app/api/auth/password-reset/route.ts)
- /api/auth/password-reset/verify (app/api/auth/password-reset/verify/route.ts)
- /api/auth/signin (app/api/auth/signin/route.ts)
- /api/auth/signout (app/api/auth/signout/route.ts)
- /api/auth/signup (app/api/auth/signup/route.ts)
- /api/beta/feedback (app/api/beta/feedback/route.ts)
- /api/beta/feedback/vote (app/api/beta/feedback/vote/route.ts)
- /api/beta/validate (app/api/beta/validate/route.ts)
- /api/budgets (app/api/budgets/route.ts)
- /api/bulk/archive-old-data (app/api/bulk/archive-old-data/route.ts)
- /api/calendar (app/api/calendar/route.ts)
- /api/calendar/[id] (app/api/calendar/[id]/route.ts)
- /api/calendar/connect/apple (app/api/calendar/connect/apple/route.ts)
- /api/calendar/connect/cozi (app/api/calendar/connect/cozi/route.ts)
- /api/calendar/connect/google (app/api/calendar/connect/google/route.ts)
- /api/calendar/connect/ics (app/api/calendar/connect/ics/route.ts)
- /api/calendar/connect/outlook (app/api/calendar/connect/outlook/route.ts)
- /api/calendar/disconnect (app/api/calendar/disconnect/route.ts)
- /api/calendar/import/ics-file (app/api/calendar/import/ics-file/route.ts)
- /api/calendar/parse-event (app/api/calendar/parse-event/route.ts)
- /api/calendar/sync (app/api/calendar/sync/route.ts)
- /api/ccpa/opt-out (app/api/ccpa/opt-out/route.ts)
- /api/chores (app/api/chores/route.ts)
- /api/cookies (app/api/cookies/route.ts)
- /api/cookies/preferences (app/api/cookies/preferences/route.ts)
- /api/cron/process-deletions (app/api/cron/process-deletions/route.ts)
- /api/expenses (app/api/expenses/route.ts)
- /api/expenses/[id] (app/api/expenses/[id]/route.ts)
- /api/feedback (app/api/feedback/route.ts)
- /api/feedback/[id] (app/api/feedback/[id]/route.ts)
- /api/geographic/detect (app/api/geographic/detect/route.ts)
- /api/goals (app/api/goals/route.ts)
- /api/goals/[id] (app/api/goals/[id]/route.ts)
- /api/invitations/accept (app/api/invitations/accept/route.ts)
- /api/launch/notify (app/api/launch/notify/route.ts)
- /api/meals (app/api/meals/route.ts)
- /api/meals/[id] (app/api/meals/[id]/route.ts)
- /api/messages (app/api/messages/route.ts)
- /api/messages/[id] (app/api/messages/[id]/route.ts)
- /api/messages/mark-conversation-read (app/api/messages/mark-conversation-read/route.ts)
- /api/notifications (app/api/notifications/route.ts)
- /api/notifications/send-push (app/api/notifications/send-push/route.ts)
- /api/notifications/track-dismissal (app/api/notifications/track-dismissal/route.ts)
- /api/ocr/scan-receipt (app/api/ocr/scan-receipt/route.ts)
- /api/privacy/data-export (app/api/privacy/data-export/route.ts)
- /api/privacy/data-sharing (app/api/privacy/data-sharing/route.ts)
- /api/privacy/generate-export (app/api/privacy/generate-export/route.ts)
- /api/privacy/marketing-subscription (app/api/privacy/marketing-subscription/route.ts)
- /api/privacy/preferences (app/api/privacy/preferences/route.ts)
- /api/projects (app/api/projects/route.ts)
- /api/projects/[id] (app/api/projects/[id]/route.ts)
- /api/recipes/parse (app/api/recipes/parse/route.ts)
- /api/reminders (app/api/reminders/route.ts)
- /api/reminders/[id] (app/api/reminders/[id]/route.ts)
- /api/settings/privacy-data (app/api/settings/privacy-data/route.ts)
- /api/shopping (app/api/shopping/route.ts)
- /api/shopping/[id] (app/api/shopping/[id]/route.ts)
- /api/shopping/[id]/sharing (app/api/shopping/[id]/sharing/route.ts)
- /api/shopping/generate-from-meals (app/api/shopping/generate-from-meals/route.ts)
- /api/shopping/share/[token] (app/api/shopping/share/[token]/route.ts)
- /api/spaces/[spaceId]/export (app/api/spaces/[spaceId]/export/route.ts)
- /api/spaces/create (app/api/spaces/create/route.ts)
- /api/spaces/invite (app/api/spaces/invite/route.ts)
- /api/stripe/webhook (app/api/stripe/webhook/route.ts)
- /api/subscriptions/check-upgrade (app/api/subscriptions/check-upgrade/route.ts)
- /api/subscriptions/usage (app/api/subscriptions/usage/route.ts)
- /api/tasks (app/api/tasks/route.ts)
- /api/tasks/[id] (app/api/tasks/[id]/route.ts)
- /api/test/email-templates (app/api/test/email-templates/route.ts)
- /api/upload/avatar (app/api/upload/avatar/route.ts)
- /api/upload/recipe (app/api/upload/recipe/route.ts)
- /api/user/sessions/[sessionId] (app/api/user/sessions/[sessionId]/route.ts)
- /api/user/track-session (app/api/user/track-session/route.ts)
- /api/weather/user-location (app/api/weather/user-location/route.ts)
- /api/webhooks/stripe (app/api/webhooks/stripe/route.ts)
- /api/year-in-review (app/api/year-in-review/route.ts)

## TEST_ENDPOINT (3)
- /api/test-cookies (app/api/test-cookies/route.ts)
- /api/test-sentry (app/api/test-sentry/route.ts)
- /api/test/email-templates (app/api/test/email-templates/route.ts)

## USES_SERVICE_ROLE_KEY (4)
- /api/admin/logs (app/api/admin/logs/route.ts)
- /api/auth/cleanup-orphaned-user (app/api/auth/cleanup-orphaned-user/route.ts)
- /api/cron/beta-expiration-emails (app/api/cron/beta-expiration-emails/route.ts)
- /api/messages/mark-conversation-read (app/api/messages/mark-conversation-read/route.ts)
