"use strict";exports.id=5869,exports.ids=[5869],exports.modules={75901:(e,t,a)=>{a.d(t,{Y:()=>n});var r=a(42945);let n={async getConversations(e){let t=(0,r.e)(),{data:a,error:n}=await t.from("conversations").select("*").eq("space_id",e).order("updated_at",{ascending:!1});if(n)throw n;return a||[]},async createConversation(e){let t=(0,r.e)(),{data:a,error:n}=await t.from("conversations").insert([{space_id:e.space_id,title:e.title,participants:e.participants,unread_count:0}]).select().single();if(n)throw n;return a},async getMessages(e){let t=(0,r.e)(),{data:a,error:n}=await t.from("messages").select("*").eq("conversation_id",e).order("created_at",{ascending:!0});if(n)throw n;return a||[]},async getMessageById(e){let t=(0,r.e)(),{data:a,error:n}=await t.from("messages").select("*").eq("id",e).single();if(n)throw n;return a},async createMessage(e){let t=(0,r.e)(),{data:a,error:n}=await t.from("messages").insert([{...e,read:!1}]).select().single();if(n)throw n;return await t.from("conversations").update({updated_at:new Date().toISOString()}).eq("id",e.conversation_id),a},async updateMessage(e,t){let a=(0,r.e)(),{data:n,error:i}=await a.from("messages").update(t).eq("id",e).select().single();if(i)throw i;return n},async deleteMessage(e){let t=(0,r.e)(),{error:a}=await t.from("messages").delete().eq("id",e);if(a)throw a},async markAsRead(e){return(0,r.e)(),this.updateMessage(e,{read:!0})},async markConversationAsRead(e){let t=(0,r.e)(),{error:a}=await t.from("messages").update({read:!0,read_at:new Date().toISOString()}).eq("conversation_id",e).eq("read",!1);if(a)throw a},async getMessageStats(e){let t=(0,r.e)(),[a,n]=await Promise.all([t.from("messages").select("*, conversation:conversations!inner(space_id)").eq("conversation.space_id",e),t.from("conversations").select("id").eq("space_id",e)]);if(a.error)throw a.error;if(n.error)throw n.error;let i=a.data||[],s=n.data||[],l=new Date,o=new Date(l);o.setHours(0,0,0,0);let d=new Date(l);return d.setDate(l.getDate()-l.getDay()),d.setHours(0,0,0,0),{thisWeek:i.filter(e=>new Date(e.created_at)>=d).length,unread:i.filter(e=>!e.read).length,today:i.filter(e=>new Date(e.created_at)>=o).length,total:i.length,conversations:s.length}},async searchMessages(e,t){let a=(0,r.e)(),{data:n,error:i}=await a.from("messages").select("*, conversation:conversations!inner(space_id)").eq("conversation.space_id",e).ilike("content",`%${t}%`).order("created_at",{ascending:!1}).limit(50);if(i)throw i;return n||[]}}},60423:(e,t,a)=>{a.d(t,{i$:()=>s,p6:()=>i,yh:()=>l});var r=a(39729),n=a(90187);function i(e,t){return(0,r.WU)((0,n.D)(e),t)}function s(e,t){return(0,r.WU)(new Date(e),t)}function l(){return(0,r.WU)(new Date,"yyyy-MM-dd")}},1572:(e,t,a)=>{a.d(t,{Z:()=>r});let r=(0,a(62881).Z)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]])},67597:(e,t,a)=>{a.d(t,{E:()=>i});var r=a(47602),n=a(77120);function i(e,t,a){let i=(0,n.Q)(e,a?.in);return isNaN(t)?(0,r.L)(a?.in||e,NaN):(t&&i.setDate(i.getDate()+t),i)}},47175:(e,t,a)=>{a.d(t,{y:()=>n});var r=a(47602);function n(e){return(0,r.L)(e,Date.now())}},78432:(e,t,a)=>{a.d(t,{K:()=>i});var r=a(86527),n=a(44071);function i(e,t,a){let[i,s]=(0,r.d)(a?.in,e,t);return+(0,n.b)(i)==+(0,n.b)(s)}},93456:(e,t,a)=>{a.d(t,{z:()=>s});var r=a(47602),n=a(47175),i=a(78432);function s(e,t){return(0,i.K)((0,r.L)(t?.in||e,e),(0,n.y)(t?.in||e))}},90187:(e,t,a)=>{a.d(t,{D:()=>s});var r=a(88802),n=a(47602),i=a(77120);function s(e,t){let a,s;let w=()=>(0,n.L)(t?.in,NaN),p=t?.additionalDigits??2,D=function(e){let t;let a={},r=e.split(l.dateTimeDelimiter);if(r.length>2)return a;if(/:/.test(r[0])?t=r[0]:(a.date=r[0],t=r[1],l.timeZoneDelimiter.test(a.date)&&(a.date=e.split(l.timeZoneDelimiter)[0],t=e.substr(a.date.length,e.length))),t){let e=l.timezone.exec(t);e?(a.time=t.replace(e[1],""),a.timezone=e[1]):a.time=t}return a}(e);if(D.date){let e=function(e,t){let a=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(a);if(!r)return{year:NaN,restDateString:""};let n=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:null===i?n:100*i,restDateString:e.slice((r[1]||r[2]).length)}}(D.date,p);a=function(e,t){if(null===t)return new Date(NaN);let a=e.match(o);if(!a)return new Date(NaN);let r=!!a[4],n=u(a[1]),i=u(a[2])-1,s=u(a[3]),l=u(a[4]),d=u(a[5])-1;if(r)return l>=1&&l<=53&&d>=0&&d<=6?function(e,t,a){let r=new Date(0);r.setUTCFullYear(e,0,4);let n=r.getUTCDay()||7;return r.setUTCDate(r.getUTCDate()+((t-1)*7+a+1-n)),r}(t,l,d):new Date(NaN);{let e=new Date(0);return i>=0&&i<=11&&s>=1&&s<=(g[i]||(m(t)?29:28))&&n>=1&&n<=(m(t)?366:365)?(e.setUTCFullYear(t,i,Math.max(n,s)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!a||isNaN(+a))return w();let h=+a,y=0;if(D.time&&isNaN(y=function(e){let t=e.match(d);if(!t)return NaN;let a=f(t[1]),n=f(t[2]),i=f(t[3]);return(24===a?0===n&&0===i:i>=0&&i<60&&n>=0&&n<60&&a>=0&&a<25)?a*r.vh+n*r.yJ+1e3*i:NaN}(D.time)))return w();if(D.timezone){if(isNaN(s=function(e){if("Z"===e)return 0;let t=e.match(c);if(!t)return 0;let a="+"===t[1]?-1:1,n=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return i>=0&&i<=59?a*(n*r.vh+i*r.yJ):NaN}(D.timezone)))return w()}else{let e=new Date(h+y),a=(0,i.Q)(0,t?.in);return a.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),a.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),a}return(0,i.Q)(h+y+s,t?.in)}let l={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},o=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,d=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,c=/^([+-])(\d{2})(?::?(\d{2}))?$/;function u(e){return e?parseInt(e):1}function f(e){return e&&parseFloat(e.replace(",","."))||0}let g=[31,null,31,30,31,30,31,31,30,31,30,31];function m(e){return e%400==0||e%4==0&&e%100!=0}},80655:(e,t,a)=>{a.d(t,{k:()=>n});var r=a(67597);function n(e,t,a){return(0,r.E)(e,-t,a)}}};