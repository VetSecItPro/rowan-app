{
  "auditDate": "2026-01-22T00:00:00.000Z",
  "project": "rowan-app",
  "summary": {
    "critical": 0,
    "high": 0,
    "medium": 3,
    "low": 2,
    "info": 3,
    "autoFixed": 4
  },
  "autoFixed": [
    {
      "id": "FIX-001",
      "description": "jsPDF updated to v4.0.0 - vulnerability resolved",
      "fixedDate": "2026-01-22"
    },
    {
      "id": "FIX-002",
      "description": "Tables active_chat_prompt and active_summarizer_prompt verified as non-existent in database - no fix required",
      "fixedDate": "2026-01-22"
    },
    {
      "id": "FIX-003",
      "description": "Tables active_chat_prompt and active_summarizer_prompt verified as non-existent in database - no fix required",
      "fixedDate": "2026-01-22"
    },
    {
      "id": "FIX-009",
      "description": "Reviewed Math.random() usage - all instances are for non-security-sensitive purposes (sampling, mock data, jitter)",
      "fixedDate": "2026-01-22"
    }
  ],
  "findings": [
    {
      "id": "FIX-004",
      "category": "auth_config",
      "severity": "medium",
      "title": "OTP Expiry Time Too Long",
      "file": "Supabase Auth Configuration",
      "line": null,
      "code": "OTP expiry > 1 hour",
      "description": "The email provider OTP expiry is set to more than 1 hour, increasing risk of OTP interception attacks.",
      "remediation": "Set OTP expiry to less than 1 hour in Supabase Dashboard > Authentication > Email",
      "status": "requires_dashboard_change"
    },
    {
      "id": "FIX-005",
      "category": "auth_config",
      "severity": "medium",
      "title": "Leaked Password Protection Disabled",
      "file": "Supabase Auth Configuration",
      "line": null,
      "code": "Leaked password protection: disabled",
      "description": "Supabase Auth leaked password protection is disabled. Enable to prevent use of compromised passwords.",
      "remediation": "Enable in Supabase Dashboard > Authentication > Password Security",
      "status": "requires_dashboard_change"
    },
    {
      "id": "FIX-006",
      "category": "database",
      "severity": "medium",
      "title": "PostgreSQL Security Patches Available",
      "file": "Supabase Infrastructure",
      "line": null,
      "code": "supabase-postgres-17.4.1.041",
      "description": "Current PostgreSQL version has outstanding security patches available.",
      "remediation": "Upgrade via Supabase Dashboard: https://supabase.com/docs/guides/platform/upgrading",
      "status": "requires_dashboard_change"
    },
    {
      "id": "FIX-011",
      "category": "environment",
      "severity": "low",
      "title": ".env.local File Present",
      "file": ".env.local",
      "line": null,
      "code": ".env.local exists",
      "description": "A .env.local file is present. Verified: properly gitignored via .env*.local pattern.",
      "remediation": "No action needed - file is properly ignored",
      "status": "verified_ok"
    },
    {
      "id": "FIX-012",
      "category": "security_headers",
      "severity": "low",
      "title": "Security Headers Disabled in Development",
      "file": "next.config.mjs:104",
      "line": 104,
      "code": "return [] in development",
      "description": "All security headers disabled in development mode.",
      "remediation": "Acceptable for development - headers are enabled in production",
      "status": "acceptable_risk"
    },
    {
      "id": "FIX-013",
      "category": "security_headers",
      "severity": "info",
      "title": "CSP Uses unsafe-inline and unsafe-eval",
      "file": "next.config.mjs:120",
      "line": 120,
      "code": "script-src unsafe-inline unsafe-eval",
      "description": "CSP includes unsafe-inline and unsafe-eval (documented as necessary for Next.js).",
      "remediation": "Consider nonce-based CSP when Next.js support stabilizes",
      "status": "acceptable_risk"
    },
    {
      "id": "FIX-014",
      "category": "api_security",
      "severity": "info",
      "title": "Service Role Key Usage in Server Code",
      "file": "Multiple server files",
      "line": null,
      "code": "SUPABASE_SERVICE_ROLE_KEY usage",
      "description": "Service role key used in server-side code. Acceptable for admin operations.",
      "remediation": "Audit usage to ensure service role operations are properly protected",
      "status": "acceptable_risk"
    },
    {
      "id": "FIX-015",
      "category": "logging",
      "severity": "info",
      "title": "Console.log Statements in Production Code",
      "file": "lib/, components/",
      "line": null,
      "code": "Console statements",
      "description": "Console statements found. Production builds strip these via compiler config.",
      "remediation": "Acceptable - Next.js compiler removes console.log in production",
      "status": "acceptable_risk"
    }
  ],
  "recommendations": {
    "immediate": [],
    "shortTerm": [
      "Enable leaked password protection in Supabase Dashboard",
      "Reduce OTP expiry to < 1 hour in Supabase Dashboard",
      "Apply PostgreSQL security patches via Supabase Dashboard"
    ],
    "resolved": [
      "jsPDF vulnerability - updated to v4.0.0",
      "Math.random() usage reviewed - all non-security-sensitive",
      ".env.local properly gitignored",
      "active_chat_prompt and active_summarizer_prompt RLS policies - tables verified as non-existent in database"
    ]
  }
}
